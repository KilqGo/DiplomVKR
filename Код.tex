\appendix{–§—Ä–∞–≥–º–µ–Ω—Ç—ã –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã}


Order\_form.php
\begin{lstlisting}[language=Php, frame=none]
// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SQL
$host = 'localhost';
$user = 'root';
$password = '';
$db_name = 'web_magazin';

$link = mysqli_connect($host, $user, $password, $db_name);

if (!$link) {
	die("–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: " . mysqli_connect_error());
}

function getComponents($link, $table, $id_col, $name_col, $check_stock = false) {
	$data = [];
	$sql = $check_stock 
	? "SELECT $id_col, $name_col, stock FROM $table WHERE stock > 0"
	: "SELECT $id_col, $name_col FROM $table";
	
	$result = mysqli_query($link, $sql);
	if ($result && mysqli_num_rows($result) > 0) {
		while ($row = mysqli_fetch_assoc($result)) {
			$item = ['name' => $row[$name_col]];
			if ($check_stock) $item['stock'] = $row['stock'];
			$data[$row[$id_col]] = $item;
		}
	}
	return $data;
}

$customers = getComponents($link, 'customer', 'ctr_id', 'full_name');
$masters = getComponents($link, 'master', 'mtr_id', 'full_name');

$components = [
'gpu' => getComponents($link, 'gpu', 'gpu_id', 'gpu_name', true),
'mcase' => getComponents($link, 'mcase', 'cse_id', 'case_name', true),
'motherboard' => getComponents($link, 'motherboard', 'mbd_id', 'motherboard_name', true),
'powerunit' => getComponents($link, 'powerunit', 'psu_id', 'power_name', true),
'processor' => getComponents($link, 'processor', 'cpu_id', 'unit_name', true),
'ram' => getComponents($link, 'ram', 'ram_id', 'ram_name', true),
'storage' => getComponents($link, 'storage', 'sdu_id', 'storage_name', true)
];

$errors = [];
$success_message = '';

if ($_SERVER["REQUEST_METHOD"] == "POST") {
	// –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
	$assembly_price = $_POST["assembly_price"];
	if (strlen($assembly_price) > 6) {
		$errors['assembly_price'] = "–¶–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ –±–æ–ª–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤.";
	} elseif (!is_numeric($assembly_price) || $assembly_price < 0) {
		$errors['assembly_price'] = "–¶–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º.";
	}
	
	$delivery_address = $_POST["delivery_address"];
	if (strlen($delivery_address) > 110) {
		$errors['delivery_address'] = "–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å 110 —Å–∏–º–≤–æ–ª–æ–≤.";
	}
	
	$date_of_admission = $_POST["date_of_admission"];
	$date_of_delivery = $_POST["date_of_delivery"];
	
	if (strtotime($date_of_admission) > time()) {
		$errors['date_of_admission'] = "–î–∞—Ç–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –±—É–¥—É—â–µ–º.";
	}
	
	if (strtotime($date_of_delivery) < strtotime($date_of_admission)) {
		$errors['date_of_delivery'] = "–î–∞—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–∑–∂–µ –¥–∞—Ç—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è.";
	}
	
	$component_ids = [
	'gpu_id' => $_POST['gpu_id'],
	'cse_id' => $_POST['cse_id'],
	'mbd_id' => $_POST['mbd_id'],
	'psu_id' => $_POST['psu_id'],
	'cpu_id' => $_POST['cpu_id'],
	'ram_id' => $_POST['ram_id'],
	'sdu_id' => $_POST['sdu_id']
	];
	
	if (empty($errors)) {
		mysqli_autocommit($link, false);
		
		try {
			// –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
			foreach ($component_ids as $field => $id) {
				$table = get_table_name($field);
				$stmt = $link->prepare("SELECT stock FROM $table WHERE ".get_id_column($table)." = ? FOR UPDATE");
				$stmt->bind_param("i", $id);
				$stmt->execute();
				$result = $stmt->get_result();
				
				if (!$result || $result->num_rows === 0) {
					throw new Exception("–ö–æ–º–ø–æ–Ω–µ–Ω—Ç $table –Ω–µ –Ω–∞–π–¥–µ–Ω");
				}
				
				$row = $result->fetch_assoc();
				if ($row['stock'] < 1) {
					throw new Exception("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ $table –Ω–∞ —Å–∫–ª–∞–¥–µ");
				}
			}
			
			// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
			$stmt = $link->prepare("INSERT INTO assembly (
			assembly_price, date_of_admission, date_of_delivery, delivery_address,
			ctr_id, mtr_id, gpu_id, cse_id, mbd_id, psu_id, cpu_id, ram_id, sdu_id
			) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)");
			
			$stmt->bind_param("dsssiiiiiiiii",
			$_POST['assembly_price'],
			$_POST['date_of_admission'],
			$_POST['date_of_delivery'],
			$_POST['delivery_address'],
			$_POST['ctr_id'],
			$_POST['mtr_id'],
			$_POST['gpu_id'],
			$_POST['cse_id'],
			$_POST['mbd_id'],
			$_POST['psu_id'],
			$_POST['cpu_id'],
			$_POST['ram_id'],
			$_POST['sdu_id']
			);
			
			if (!$stmt->execute()) throw new Exception("–û—à–∏–±–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è: ".$stmt->error);
			
			// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤
			foreach ($component_ids as $field => $id) {
				$table = get_table_name($field);
				$stmt = $link->prepare("UPDATE $table SET stock = stock - 1 WHERE ".get_id_column($table)." = ?");
				$stmt->bind_param("i", $id);
				if (!$stmt->execute()) throw new Exception("–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ".$stmt->error);
			}
			
			mysqli_commit($link);
			$success_message = "–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω!";
		} catch (Exception $e) {
			mysqli_rollback($link);
			$errors[] = $e->getMessage();
		} finally {
			mysqli_autocommit($link, true);
		}
	}
}

function get_id_column($table) {
	$columns = [
	'gpu' => 'gpu_id',
	'mcase' => 'cse_id',
	'motherboard' => 'mbd_id',
	'powerunit' => 'psu_id',
	'processor' => 'cpu_id',
	'ram' => 'ram_id',
	'storage' => 'sdu_id'
	];
	return $columns[$table] ?? 'id';
}

function get_table_name($field) {
	$mapping = [
	'gpu_id' => 'gpu',
	'cse_id' => 'mcase',
	'mbd_id' => 'motherboard',
	'psu_id' => 'powerunit',
	'cpu_id' => 'processor',
	'ram_id' => 'ram',
	'sdu_id' => 'storage'
	];
	return $mapping[$field] ?? str_replace('_id', '', $field);
}

...

// main 
<?php if (!empty($errors)): ?>
<div class="errors">
<?php foreach ($errors as $error): ?>
<p>‚ö†Ô∏è <?= $error ?></p>
<?php endforeach; ?>
</div>
<?php endif; ?>

<?php if ($success_message): ?>
<div class="success">‚úÖ <?= $success_message ?></div>
<?php endif; ?>

<form method="post" autocomplete="off">
<label for="assembly_price">–¶–µ–Ω–∞ —Å–±–æ—Ä–∫–∏:</label>
<input type="number" id="assembly_price" name="assembly_price" 
value="<?= htmlspecialchars($_POST['assembly_price'] ?? '') ?>" required>

<label for="date_of_admission">–î–∞—Ç–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è:</label>
<input type="date" id="date_of_admission" name="date_of_admission"
value="<?= htmlspecialchars($_POST['date_of_admission'] ?? '') ?>" required>

<label for="date_of_delivery">–î–∞—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏:</label>
<input type="date" id="date_of_delivery" name="date_of_delivery" 
value="<?= htmlspecialchars($_POST['date_of_delivery'] ?? '') ?>" required>

<label for="delivery_address">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏:</label>
<input type="text" id="delivery_address" name="delivery_address" 
value="<?= htmlspecialchars($_POST['delivery_address'] ?? '') ?>" 
maxlength="110" required>

<label for="ctr_id">–ö–ª–∏–µ–Ω—Ç:</label>
<select id="ctr_id" name="ctr_id" required>
<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞</option>
<?php foreach ($customers as $id => $item): ?>
<option value="<?= $id ?>" <?= ($_POST['ctr_id'] ?? '') == $id ? 'selected' : '' ?>>
<?= htmlspecialchars($item['name']) ?>
</option>
<?php endforeach; ?>
</select>

<label for="mtr_id">–ú–∞—Å—Ç–µ—Ä:</label>
<select id="mtr_id" name="mtr_id" required>
<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Å—Ç–µ—Ä–∞</option>
<?php foreach ($masters as $id => $item): ?>
<option value="<?= $id ?>" <?= ($_POST['mtr_id'] ?? '') == $id ? 'selected' : '' ?>>
<?= htmlspecialchars($item['name']) ?>
</option>
<?php endforeach; ?>
</select>

<?php
// –ú–∞—Å—Å–∏–≤ –¥–ª—è –ø–æ–ª–µ–π —Å –ø–æ–∏—Å–∫–æ–º
$component_fields = [
'gpu_id' => ['label' => '–í–∏–¥–µ–æ–∫–∞—Ä—Ç–∞', 'data' => $components['gpu']],
'cse_id' => ['label' => '–ö–æ—Ä–ø—É—Å', 'data' => $components['mcase']],
'mbd_id' => ['label' => '–ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∞—è –ø–ª–∞—Ç–∞', 'data' => $components['motherboard']],
'psu_id' => ['label' => '–ë–ª–æ–∫ –ø–∏—Ç–∞–Ω–∏—è', 'data' => $components['powerunit']],
'cpu_id' => ['label' => '–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä', 'data' => $components['processor']],
'ram_id' => ['label' => '–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å', 'data' => $components['ram']],
'sdu_id' => ['label' => '–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å', 'data' => $components['storage']]
];
foreach ($component_fields as $field => $config):
$input_value = '';
// –ü–æ–ª—É—á–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ id, –µ—Å–ª–∏ –µ—Å—Ç—å
if (isset($_POST[$field]) && $_POST[$field] && isset($config['data'][$_POST[$field]])) {
	$input_value = htmlspecialchars($config['data'][$_POST[$field]]['name']);
}
?>
<label for="<?= $field ?>_input"><?= $config['label'] ?>:</label>
<div class="dropdown-field">
<input type="text"
class="dropdown-input"
id="<?= $field ?>_input"
name="<?= $field ?>_input"
placeholder="–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å..."
value="<?= $input_value ?>"
autocomplete="off"
data-dropdown="<?= $field ?>"
required
style="background:#333;cursor:pointer;"
>
<button type="button" class="dropdown-btn" tabindex="-1" onclick="toggleDropdown('<?= $field ?>')">&#x25BC;</button>
<ul class="dropdown-list" id="<?= $field ?>_list">
<li data-value="">–í—ã–±–µ—Ä–∏—Ç–µ <?= mb_strtolower($config['label']) ?>...</li>
<?php foreach ($config['data'] as $id => $item): ?>
<li data-value="<?= $id ?>">
<?= htmlspecialchars($item['name']) ?>
<?php if(isset($item['stock'])): ?>
<span class="stock-info">(–û—Å—Ç: <?= $item['stock'] ?>)</span>
<?php endif; ?>
</li>
<?php endforeach; ?>
</ul>
<input type="hidden" name="<?= $field ?>" id="<?= $field ?>" value="<?= htmlspecialchars($_POST[$field] ?? '') ?>">
</div>
<?php endforeach; ?>

<input type="submit" value="–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑">
</form>

...

//skript
<script>
document.querySelectorAll('.dropdown-input').forEach(function(input) {
	input.addEventListener('focus', function() {
		showDropdown(this.dataset.dropdown);
	});
	input.addEventListener('input', function() {
		filterDropdown(this.dataset.dropdown, this.value);
	});
});

// –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–Ω–æ–ø–∫–µ
function toggleDropdown(field) {
	var list = document.getElementById(field + '_list');
	list.classList.toggle('show');
	document.getElementById(field + '_input').focus();
}
function showDropdown(field) {
	document.querySelectorAll('.dropdown-list').forEach(function(list) {
		list.classList.remove('show');
	});
	document.getElementById(field + '_list').classList.add('show');
}

// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞
function filterDropdown(field, value) {
	var list = document.getElementById(field + '_list');
	var filter = value.toLowerCase();
	list.querySelectorAll('li').forEach(function(li, idx) {
		if (idx === 0) return; 
		li.style.display = li.textContent.toLowerCase().includes(filter) ? '' : 'none';
	});
}

// –í—ã–±–æ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞
document.querySelectorAll('.dropdown-list').forEach(function(list) {
	list.addEventListener('click', function(e) {
		if (e.target.tagName.toLowerCase() === 'li') {
			var val = e.target.getAttribute('data-value');
			var field = this.id.replace('_list','');
			var input = document.getElementById(field + '_input');
			var hidden = document.getElementById(field);
			if (val) {
				input.value = e.target.childNodes[0].textContent.trim();
				hidden.value = val;
			} else {
				input.value = '';
				hidden.value = '';
			}
			this.classList.remove('show');
		}
	});
});

// –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–ø–∏—Å–∫–∞ –∫–ª–∏–∫
document.addEventListener('click', function(e) {
	if (!e.target.classList.contains('dropdown-input') && !e.target.classList.contains('dropdown-btn')) {
		document.querySelectorAll('.dropdown-list').forEach(function(list) {
			list.classList.remove('show');
		});
	}
});
</script>
\end{lstlisting}

Edit\_content.php

\begin{lstlisting}[language=Php, frame=none]
if (!isset($_SESSION['user_id']) || $_SESSION['adminflag'] != 1) {
	header("Location: login.php");
	exit;
}

$selected_table = $_GET['table'] ?? 'assembly';
$search_query = $_GET['search'] ?? '';

// –ú–∞—Å—Å–∏–≤—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–∞–±–ª–∏—Ü
$table_headers = [
'assembly' => ['ID', '–¶–µ–Ω–∞', '–î–∞—Ç–∞ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è', '–î–∞—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏', '–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏', 'ID –∫–ª–∏–µ–Ω—Ç–∞', 'ID –º–∞—Å—Ç–µ—Ä–∞', 'GPU ID', 'Case ID', 'Motherboard ID', 'Power Unit ID', 'Processor ID', 'RAM ID', 'Storage ID', '–î–µ–π—Å—Ç–≤–∏—è'],
'master' => ['ID', '–ò–º—è', '–¢–µ–ª–µ—Ñ–æ–Ω', '–ê–¥—Ä–µ—Å', '–î–µ–π—Å—Ç–≤–∏—è'],
'customer' => ['ID', '–ò–º—è', '–¢–µ–ª–µ—Ñ–æ–Ω', '–ê–¥—Ä–µ—Å', '–î–µ–π—Å—Ç–≤–∏—è'],
'gpu' => ['ID', '–ù–∞–∑–≤–∞–Ω–∏–µ', '–û–±—ä–µ–º –ø–∞–º—è—Ç–∏', '–°–µ—Ä–∏—è', '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å', '–¶–µ–Ω–∞', '–î–µ–π—Å—Ç–≤–∏—è'],
'mcase' => ['ID', '–ù–∞–∑–≤–∞–Ω–∏–µ', '–§–æ—Ä–º-—Ñ–∞–∫—Ç–æ—Ä', '–†–∞–∑–º–µ—Ä', '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å', '–¶–µ–Ω–∞', '–î–µ–π—Å—Ç–≤–∏—è'],
'motherboard' => ['ID', '–ù–∞–∑–≤–∞–Ω–∏–µ', '–§–æ—Ä–º-—Ñ–∞–∫—Ç–æ—Ä', '–ß–∏–ø—Å–µ—Ç', '–°–æ–∫–µ—Ç', '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å', '–¶–µ–Ω–∞', '–î–µ–π—Å—Ç–≤–∏—è'],
'powerunit' => ['ID', '–ù–∞–∑–≤–∞–Ω–∏–µ', '–ú–æ—â–Ω–æ—Å—Ç—å', '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å', '–¶–µ–Ω–∞', '–î–µ–π—Å—Ç–≤–∏—è'],
'processor' => ['ID', '–ù–∞–∑–≤–∞–Ω–∏–µ', '–°–æ–∫–µ—Ç', '–ë–∞–∑–æ–≤–∞—è —á–∞—Å—Ç–æ—Ç–∞', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä', '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å', '–¶–µ–Ω–∞', '–î–µ–π—Å—Ç–≤–∏—è'],
'ram' => ['ID', '–ù–∞–∑–≤–∞–Ω–∏–µ', '–û–±—ä–µ–º –ø–∞–º—è—Ç–∏', '–¢–∏–ø', '–ß–∞—Å—Ç–æ—Ç–∞', '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å', '–¶–µ–Ω–∞', '–î–µ–π—Å—Ç–≤–∏—è'],
'storage' => ['ID', '–ù–∞–∑–≤–∞–Ω–∏–µ', '–û–±—ä–µ–º', '–°–∫–æ—Ä–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è', '–¢–∏–ø', '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å', '–¶–µ–Ω–∞', '–î–µ–π—Å—Ç–≤–∏—è']
];

$table_columns = [
'assembly' => ['assembly_order_id', 'assembly_price', 'date_of_admission', 'date_of_delivery', 'delivery_address', 'ctr_id', 'mtr_id', 'gpu_id', 'cse_id', 'mbd_id', 'psu_id', 'cpu_id', 'ram_id', 'sdu_id'],
'master' => ['mtr_id', 'full_name', 'phone_number', 'legal_address'],
'customer' => ['ctr_id', 'full_name', 'phone_number', 'legal_address'],
'gpu' => ['gpu_id', 'gpu_name', 'gmemory_size', 'gpu_series', 'gpu_manufacturer', 'price'],
'mcase' => ['cse_id', 'case_name', 'form_factor', 'case_size', 'case_manufacturer', 'price'],
'motherboard' => ['mbd_id', 'motherboard_name', 'form_factor', 'chipset', 'socket', 'board_manufacturer', 'price'],
'powerunit' => ['psu_id', 'power_name', 'capability', 'power_manufacturer', 'price'],
'processor' => ['cpu_id', 'unit_name', 'socket', 'base_frequency', 'number_of_cores', 'cpu_manufacturer', 'price'],
'ram' => ['ram_id', 'ram_name', 'memory_size', 'type', 'base_frequency', 'ram_manufacturer', 'price'],
'storage' => ['sdu_id', 'storage_name', 'storage_capacity', 'reading_speed', 'sdu_type', 'sdu_manufacturer', 'price']
];

$search_columns = [
'assembly' => 'assembly_order_id',
'master' => 'full_name',
'customer' => 'full_name',
'gpu' => 'gpu_name',
'mcase' => 'case_name',
'motherboard' => 'motherboard_name',
'powerunit' => 'power_name',
'processor' => 'unit_name',
'ram' => 'ram_name',
'storage' => 'storage_name'
];

<body>
<header>
<h1>üîß –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å PC Club</h1>
<nav>
<ul>
<li><a href="stock_management.php">üì¶ –°–∫–ª–∞–¥</a></li>
<li><a href="index.php">üè† –ì–ª–∞–≤–Ω–∞—è</a></li>
<li><a href="order_form.php">üõí –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</a></li>
<li><a href="logout.php">üö™ –í—ã–π—Ç–∏</a></li>
</ul>
</nav>
</header>

<div class="main-container">
<form method="get">
<div class="controls">
<select name="table" onchange="this.form.submit()">
<option value="assembly" <?= $selected_table == 'assembly' ? 'selected' : '' ?>>üéÅ –°–±–æ—Ä–∫–∏</option>
<option value="master" <?= $selected_table == 'master' ? 'selected' : '' ?>>üë®üíº –ú–∞—Å—Ç–µ—Ä–∞</option>
<option value="customer" <?= $selected_table == 'customer' ? 'selected' : '' ?>>üë• –ö–ª–∏–µ–Ω—Ç—ã</option>
<option value="gpu" <?= $selected_table == 'gpu' ? 'selected' : '' ?>>üéÆ –í–∏–¥–µ–æ–∫–∞—Ä—Ç—ã</option>
<option value="mcase" <?= $selected_table == 'mcase' ? 'selected' : '' ?>>üñ•Ô∏è –ö–æ—Ä–ø—É—Å–∞</option>
<option value="motherboard" <?= $selected_table == 'motherboard' ? 'selected' : '' ?>>üîå –ú–∞—Ç–µ—Ä–∏–Ω–∫–∏</option>
<option value="powerunit" <?= $selected_table == 'powerunit' ? 'selected' : '' ?>>üîã –ë–ª–æ–∫–∏ –ø–∏—Ç–∞–Ω–∏—è</option>
<option value="processor" <?= $selected_table == 'processor' ? 'selected' : '' ?>>‚ö° –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã</option>
<option value="ram" <?= $selected_table == 'ram' ? 'selected' : '' ?>>üíæ –û–ó–£</option>
<option value="storage" <?= $selected_table == 'storage' ? 'selected' : '' ?>>üíΩ –ù–∞–∫–æ–ø–∏—Ç–µ–ª–∏</option>
</select>

<div class="search-group">
<input type="text" name="search" placeholder="üîç –ü–æ–∏—Å–∫..." value="<?= htmlspecialchars($search_query) ?>">
<button type="submit">–ù–∞–π—Ç–∏</button>
</div>

<a href="add_data.php?table=<?= $selected_table ?>" class="button">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å</a>
</div>
</form>
<div class="table-container">
<table class="data-table">
<thead>
<tr>
<?php foreach ($table_headers[$selected_table] as $header): ?>
<th><?= htmlspecialchars($header) ?></th>
<?php endforeach; ?>
</tr>
</thead>
<tbody>
<?php
$sql = "SELECT * FROM $selected_table";
$params = [];

...

if (!empty($search_query)) {
	$search_column = $search_columns[$selected_table];
	$sql .= " WHERE $search_column LIKE ?";
	$params[] = "%$search_query%";
}

$stmt = $link->prepare($sql);

if ($stmt) {
	if (!empty($params)) {
		$stmt->bind_param(str_repeat('s', count($params)), ...$params);
	}
	
	$stmt->execute();
	$result = $stmt->get_result();
	
	while ($row = $result->fetch_assoc()):
	?>
	<tr>
	<?php foreach ($table_columns[$selected_table] as $column): ?>
	<td><?= htmlspecialchars($row[$column] ?? 'N/A') ?></td>
	<?php endforeach; ?>
	<td class="actions-cell">
	<button onclick="editData('<?= $selected_table ?>', <?= $row[$table_columns[$selected_table][0]] ?>)">‚úèÔ∏è</button>
	<button onclick="deleteData('<?= $selected_table ?>', <?= $row[$table_columns[$selected_table][0]] ?>)">üóëÔ∏è</button>
	<?php if($selected_table === 'assembly'): ?>
	<button onclick="exportAssembly(<?= $row['assembly_order_id'] ?>)">üì§ –≠–∫—Å–ø–æ—Ä—Ç</button>
	<?php endif; ?>
	</td>
	</tr>
	<?php
	endwhile;
} else {
	echo '<tr><td colspan="100%">–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞</td></tr>';
}
?>
</tbody>
</table>
</div>
</div>

<footer>
¬© <?= date('Y') ?> PC Club | –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã
</footer>

<script>
function editData(table, id) {
	window.location.href = `edit_form.php?table=${table}&id=${id}`;
}

function exportAssembly(id) {
	window.open(`export.php?table=assembly&id=${id}&format=doc`, '_blank');
}

function deleteData(table, id) {
	if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å?')) {
		const xhr = new XMLHttpRequest();
		xhr.open('POST', 'delete_data.php', true);
		xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
		xhr.onload = function() {
			if (xhr.status === 200) {
				alert(xhr.responseText);
				location.reload();
			} else {
				alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏');
			}
		};
		xhr.send(`table=${table}&id=${id}`);
	}
}
</script>
</body>
</html>
\end{lstlisting}

Edit\_form.php

\begin{lstlisting}[language=Php, frame=none]
<div class="main-container">
<?php if (isset($_SESSION['errors'])): ?>
<div class="alert alert-error">
<?php foreach ($_SESSION['errors'] as $error): ?>
<div>‚ùå <?= $error ?></div>
<?php endforeach; ?>
<?php unset($_SESSION['errors']); unset($_SESSION['old']); ?>
</div>
<?php endif; ?>

<h2 class="form-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ç–∞–±–ª–∏—Ü–µ: <?= htmlspecialchars($table) ?></h2>

<form class="data-form" method="post">
<?php foreach ($row as $column => $value): ?>
<?php if ($column !== $idColumn): ?>
<div class="form-group">
<label><?= $column ?></label>
<input type="text" 
name="<?= $column ?>" 
value="<?= htmlspecialchars($_SESSION['old'][$column] ?? $value) ?>"
class="<?= isset($_SESSION['errors'][$column]) ? 'error-field' : '' ?>">
<?php if (isset($_SESSION['errors'][$column])): ?>
<div class="field-error"><?= $_SESSION['errors'][$column] ?></div>
<?php endif; ?>
</div>
<?php endif; ?>
<?php endforeach; ?>
<button type="submit">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
</form>
</div>
\end{lstlisting}

Add\_data.php

\begin{lstlisting}[language=PHP, frame=none]
    <div class="main-container">
<?php if (isset($_SESSION['errors'])): ?>
<div class="alert alert-error">
<?php foreach ($_SESSION['errors'] as $error): ?>
<div>‚ùå <?= $error ?></div>
<?php endforeach; ?>
<?php unset($_SESSION['errors']); unset($_SESSION['old']); ?>
</div>
<?php endif; ?>

<h2 class="form-title">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —Ç–∞–±–ª–∏—Ü—É: <?= htmlspecialchars($table) ?></h2>

<?php if ($table): ?>
<form class="data-form" method="post">
<?php
$result = $link->query("SHOW COLUMNS FROM $table");
while ($row = $result->fetch_assoc()):
$column = $row['Field'];
if ($column !== getIdColumn($table)):
?>
<div class="form-group">
<label><?= $column ?></label>
<input type="text" 
name="<?= $column ?>" 
value="<?= htmlspecialchars($_SESSION['old'][$column] ?? '') ?>"
class="<?= isset($_SESSION['errors'][$column]) ? 'error-field' : '' ?>">
<?php if (isset($_SESSION['errors'][$column])): ?>
<div class="field-error"><?= $_SESSION['errors'][$column] ?></div>
<?php endif; ?>
</div>
<?php endif; endwhile; ?>
<button type="submit">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å</button>
</form>
<?php endif; ?>
</div>
\end{lstlisting}

Delete\_data.php

\begin{lstlisting}[language=PHP, frame=none]
// –£–¥–∞–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
$idColumn = getIdColumn($table);
$sql = "DELETE FROM $table WHERE $idColumn = ?";
$stmt = $link->prepare($sql);
$stmt->bind_param("i", $id);

if ($stmt->execute()) {
	echo "–ó–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞.";
} else {
	echo "–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏: " . $link->error;
}

$stmt->close();
mysqli_close($link);
?>
\end{lstlisting}

Export.php

\begin{lstlisting}[language=php,frame=none]
foreach ($components as $key => $component) {
	$query = "SELECT {$component['name_column']} 
	FROM {$component['table']} 
	WHERE {$component['fk_column']} = ?";
	
	$stmt = $link->prepare($query);
	$stmt->bind_param('i', $assembly[$component['fk_column']]);
	$stmt->execute();
	$result = $stmt->get_result()->fetch_assoc();
	$assembly[$key] = $result[$component['name_column']] ?? '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
}

$html = '<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>–°–±–æ—Ä–∫–∞ #'.$assembly['assembly_order_id'].'</title>
<style>
body { font-family: Arial, sans-serif; }
h1 { color: #2c3e50; }
ul { list-style-type: none; padding: 0; }
li { margin: 8px 0; }
</style>
</head>
<body>
<h1>–î–µ—Ç–∞–ª–∏ —Å–±–æ—Ä–∫–∏ #'.$assembly['assembly_order_id'].'</h1>

<div>
<p><strong>–¶–µ–Ω–∞:</strong> '.number_format($assembly['assembly_price'], 0, '', ' ').' —Ä—É–±.</p>
<p><strong>–î–∞—Ç–∞ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è:</strong> '.$assembly['date_of_admission'].'</p>
<p><strong>–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏:</strong> '.$assembly['delivery_address'].'</p>
</div>

<h2>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:</h2>
<ul>';

foreach ($components as $key => $component) {
	$html .= '<li><strong>'.ucfirst($key).':</strong> '.$assembly[$key].'</li>';
}

$html .= '</ul>
</body>
</html>';

header("Content-Type: application/msword");
header("Content-Disposition: attachment; filename=assembly_".$id.".doc");
header("Content-Transfer-Encoding: binary");
header("Expires: 0");
echo $html;
\end{lstlisting}

Login.php

\begin{lstlisting}[language=PHP,frame=none]
if (isset($_SESSION['user_id'])) {
	if ($_SESSION['adminflag'] == 1) {
		header("Location: edit_content.php");
	} else {
		header("Location: index.php");
	}
	exit;
}

$error = '';

if ($_SERVER["REQUEST_METHOD"] == "POST") {
	if (isset($_POST['login'])) {
		// –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞
		$username = $_POST['username'];
		$password = $_POST['password'];
		
		$sql = "SELECT id, password, adminflag FROM users WHERE login = ?";
		$stmt = mysqli_prepare($link, $sql);
		mysqli_stmt_bind_param($stmt, "s", $username);
		mysqli_stmt_execute($stmt);
		$result = mysqli_stmt_get_result($stmt);
		
		if (mysqli_num_rows($result) > 0) {
			$user = mysqli_fetch_assoc($result);
			if (password_verify($password, $user['password'])) {
				$_SESSION['user_id'] = $user['id'];
				$_SESSION['adminflag'] = $user['adminflag'];
				if ($user['adminflag'] == 1) {
					header("Location: edit_content.php");
				} else {
					header("Location: index.php");
				}
				exit;
			} else {
				$error = "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å.";
			}
		} else {
			$error = "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω.";
		}
		mysqli_stmt_close($stmt);
	} elseif (isset($_POST['register'])) {
		// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
		$username = $_POST['username'];
		$password = $_POST['password'];
		
		// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
		$check_sql = "SELECT id FROM users WHERE login = ?";
		$stmt = mysqli_prepare($link, $check_sql);
		mysqli_stmt_bind_param($stmt, "s", $username);
		mysqli_stmt_execute($stmt);
		$check_result = mysqli_stmt_get_result($stmt);
		
		if (mysqli_num_rows($check_result) > 0) {
			$error = "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.";
		} else {
			$hashed_password = password_hash($password, PASSWORD_DEFAULT);
			$insert_sql = "INSERT INTO users (login, password, adminflag) VALUES (?, ?, 0)";
			$stmt = mysqli_prepare($link, $insert_sql);
			mysqli_stmt_bind_param($stmt, "ss", $username, $hashed_password);
			if (mysqli_stmt_execute($stmt)) {
				$error = "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞. –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏.";
			} else {
				$error = "–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: " . mysqli_error($link);
			}
		}
		mysqli_stmt_close($stmt);
	}
}

...

<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è - PC Club</title>
<link rel="stylesheet" href="style.css"> 
</head>
<body>
<header>
<h1>üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è PC Club</h1>
<nav>
<ul>
<li><a href="index.php">üè† –ì–ª–∞–≤–Ω–∞—è</a></li>
<li><a href="order_form.php">üõí –ó–∞–∫–∞–∑—ã</a></li>
</ul>
</nav>
</header>

<main>
<div class="auth-container">
<h2 class="auth-title">–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>

<?php if ($error): ?>
<div class="alert alert-error">
‚ö†Ô∏è <?= htmlspecialchars($error) ?>
</div>
<?php endif; ?>

<form method="post">
<div class="form-group">
<label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
<input type="text" 
name="username" 
required
placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ª–æ–≥–∏–Ω">
</div>

<div class="form-group">
<label>–ü–∞—Ä–æ–ª—å</label>
<input type="password" 
name="password" 
required
placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
</div>

<div class="form-group">
<button type="submit" name="login">üö™ –í–æ–π—Ç–∏</button>
<button type="submit" name="register">üìù –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
</div>
</form>

<div class="auth-switch">
<a href="index.php">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
</div>
</div>
</main>

<footer>
¬© <?= date('Y') ?> PC Club | –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã
</footer>
</body>
</html>
\end{lstlisting}

\clearpage
\if–í–ö–†{
	\newpage
	\addcontentsline{toc}{section}{–ù–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ª–∏—Å—Ç–∞—Ö (CD-RW –≤ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω–æ–º –∫–æ–Ω–≤–µ—Ä—Ç–µ)}
	\noindent
	\begin{tabular}{p{5.8cm}C{4.8cm}C{4.8cm}}
		–ê–≤—Ç–æ—Ä –í–ö–† & \lhrulefill{\fill} & \fillcenter\–ê–≤—Ç–æ—Ä \\
		\setarstrut{\footnotesize}
		& \footnotesize{(–ø–æ–¥–ø–∏—Å—å, –¥–∞—Ç–∞)} & \\
		\restorearstrut
		–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –í–ö–† & \lhrulefill{\fill} & \fillcenter\–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å \\
		\setarstrut{\footnotesize}
		& \footnotesize{(–ø–æ–¥–ø–∏—Å—å, –¥–∞—Ç–∞)} & \\
		\restorearstrut
		–ù–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å & \lhrulefill{\fill} & \fillcenter\–ù–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å \\
		\setarstrut{\footnotesize}
		& \footnotesize{(–ø–æ–¥–ø–∏—Å—å, –¥–∞—Ç–∞)} & \\
		\restorearstrut
	\end{tabular}
	\vskip 2cm
	\begin{center}
		\textbf{–ú–µ—Å—Ç–æ –¥–ª—è –¥–∏—Å–∫–∞}
	\end{center}
}\fi
